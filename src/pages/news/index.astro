---
import { getCollection } from "astro:content";
import Layout from "@layouts/Layout.astro";
import Container from "@components/Container.astro";
import FormattedDate from "@components/FormattedDate.astro";
import Link from "@components/Link.astro";
import BackToPrevious from "@components/BackToPrevious.astro";
import TagBadge from "@components/TagBadge.astro";

const newsItems = (await getCollection("news"))
  .filter((item) => !item.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<Layout
  title="News"
  description="Latest news and features about Scott Lingner's creative work."
>
  <Container>
    <aside data-pagefind-ignore>
      <h1
        class="animate mb-4 mt-10 text-4xl font-bold text-stone-900 dark:text-stone-100 md:text-5xl"
      >
        News
      </h1>
      <p class="animate mb-12 text-lg text-stone-700 dark:text-stone-300">
        Features and highlights from across my creative work.
      </p>

      <div class="grid grid-cols-1 gap-8 md:grid-cols-2 md:gap-10">
        {
          newsItems.map((item) => (
            <article class="animate h-full">
              <Link href={`/news/${item.slug}`} class="group block h-full">
                <div class="flex h-full flex-col overflow-hidden rounded-xl bg-white shadow-lg transition-all duration-500 hover:shadow-2xl dark:bg-stone-900">
                  {item.data.thumbnail && (
                    <div class="relative aspect-[16/10] overflow-hidden bg-stone-200 dark:bg-stone-800">
                      <img
                        src={item.data.thumbnail}
                        alt={item.data.title}
                        class="h-full w-full object-cover transition-all duration-700 group-hover:scale-105"
                      />
                      <div class="absolute left-4 top-4 flex flex-col gap-2">
                        <span class="inline-block rounded-full bg-stone-900/80 px-3 py-1 font-mono text-xs text-white backdrop-blur-sm dark:bg-stone-100/80 dark:text-stone-900">
                          <FormattedDate date={item.data.date} />
                        </span>
                        {item.data.tags && item.data.tags.length > 0 && (
                          <div class="flex flex-wrap gap-1">
                            {item.data.tags.map((tag) => (
                              <TagBadge tag={tag} />
                            ))}
                          </div>
                        )}
                      </div>
                    </div>
                  )}
                  <div class="flex flex-1 flex-col p-6 md:p-8">
                    <h2 class="mb-3 text-xl font-bold leading-tight text-stone-900 transition-colors group-hover:text-stone-700 dark:text-stone-100 dark:group-hover:text-stone-300 md:text-2xl">
                      {item.data.title}
                    </h2>
                    <p class="mb-4 flex-1 text-sm leading-relaxed text-stone-600 dark:text-stone-400 md:text-base">
                      {item.data.description}
                    </p>
                    <div class="flex items-center text-sm font-medium text-stone-700 transition-transform duration-300 group-hover:translate-x-2 dark:text-stone-300">
                      <span>Read more</span>
                      <svg
                        class="ml-2 h-4 w-4"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M17 8l4 4m0 0l-4 4m4-4H3"
                        />
                      </svg>
                    </div>
                  </div>
                </div>
              </Link>
            </article>
          ))
        }
      </div>
    </aside>
  </Container>
</Layout>
