---
import Container from "@components/Container.astro";
import ArrowCard from "@components/ArrowCard.astro";
import Pelican from "@components/Pelican.astro";
import { getCollection } from "astro:content";

import Layout from "@layouts/Layout.astro";

const blog = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

const projects = (await getCollection("projects"))
  .filter((project) => !project.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

const experiences = [
  {
    title: "Frontend Engineer",
    company: "Prenda",
    period: "Aug 2020 - Sep 2024",
    description:
      "Developed and styled educational interactive web apps for an EdTech platform serving thousands of students. Collaborated closely with UI/UX and curriculum teams to implement new features and optimize user experience.",
    skills: [
      "React",
      "TypeScript",
      "Next.js",
      "Node.js",
      "Tailwind",
      "MongoDB",
      "GraphQL",
    ],
    url: "https://prenda.com",
  },
  {
    title: "Frontend Engineer Intern",
    company: "untitled.stream",
    period: "Jun 2020 - Aug 2020",
    description:
      "Built a multi-layered React desktop app that expanded mobile features and improved user experience, with UX/UI designs in Figma that guided development and ensured usability.",
    skills: ["React", "JavaScript", "Typescript", "Figma", "CSS", "HTML"],
    url: "https://untitled.stream",
  },
  {
    title: "Photography Consultant for Google AI",
    company: "Filter, A Merkle Company",
    period: "Feb 2017 - May 2020",
    description:
      "Provided expertise on AI training data and quality assurance for Google's machine learning initiatives.",
    skills: ["AI/ML", "Data Analysis", "Quality Assurance"],
    url: "https://research.google/blog/using-deep-learning-to-create-professional-level-photographs/",
  },
  {
    title: "Designer/Co Founder",
    company: "Rocket Boogie Co",
    period: "2014 - Present",
    description:
      "Founded and led a design studio specializing in whimsical art and lifestyle goods, creating and selling thousands of greeting cards, art prints, and home and apparel products while managing creative direction, producing artwork, coordinating production, and handling wholesale accounts.",
    skills: ["Adobe", "Figma", "Shopify", "E-commerce", "Brand Development"],
    url: "https://rocketboogie.com",
  },
];
---

<Layout
  title="Frontend Engineer"
  description="Software engineering projects and writing by Scott Lingner."
>
  <Container>
    <div class="mt-8 flex gap-12">
      <!-- Fixed Sidebar Navigation -->
      <nav class="animate hidden w-48 flex-shrink-0 lg:block">
        <div class="sticky top-36">
          <div class="flex flex-col gap-4">
            <a
              href="#about"
              data-nav-link="about"
              class="nav-link group relative text-sm font-semibold text-stone-700 transition-colors hover:text-stone-900 dark:text-stone-300 dark:hover:text-stone-100"
            >
              About
              <span
                class="nav-underline absolute -bottom-1 left-0 h-0.5 w-0 bg-stone-900 transition-all duration-300 dark:bg-stone-100"
              ></span>
            </a>
            <a
              href="#experience"
              data-nav-link="experience"
              class="nav-link group relative text-sm font-semibold text-stone-700 transition-colors hover:text-stone-900 dark:text-stone-300 dark:hover:text-stone-100"
            >
              Experience
              <span
                class="nav-underline absolute -bottom-1 left-0 h-0.5 w-0 bg-stone-900 transition-all duration-300 dark:bg-stone-100"
              ></span>
            </a>
            <a
              href="#projects"
              data-nav-link="projects"
              class="nav-link group relative text-sm font-semibold text-stone-700 transition-colors hover:text-stone-900 dark:text-stone-300 dark:hover:text-stone-100"
            >
              Projects
              <span
                class="nav-underline absolute -bottom-1 left-0 h-0.5 w-0 bg-stone-900 transition-all duration-300 dark:bg-stone-100"
              ></span>
            </a>
            <a
              href="#writing"
              data-nav-link="writing"
              class="nav-link group relative text-sm font-semibold text-stone-700 transition-colors hover:text-stone-900 dark:text-stone-300 dark:hover:text-stone-100"
            >
              Writing
              <span
                class="nav-underline absolute -bottom-1 left-0 h-0.5 w-0 bg-stone-900 transition-all duration-300 dark:bg-stone-100"
              ></span>
            </a>
          </div>
        </div>
      </nav>

      <!-- Main Content -->
      <aside data-pagefind-ignore class="min-w-0 flex-1">
        <!-- About Section -->
        <section id="about" class="animate mb-24 scroll-mt-36">
          <h2
            class="mb-6 text-3xl font-bold text-stone-900 dark:text-stone-100"
          >
            <!-- em dash -->
            Scott Lingner &mdash; Frontend Engineer
          </h2>
          <div
            class="space-y-4 text-base leading-relaxed text-stone-700 dark:text-stone-300"
          >
            <p>
              I'm a frontend engineer with five years of experience building
              impactful applications in the EdTech space. I specialize in
              frontend development with React and TypeScript, creating intuitive
              user experiences that scale.
            </p>
            <p>
              My work at Prenda, a leading edtech startup, helped thousands of
              microschools deliver personalized education through technology.
              I'm passionate about clean code, thoughtful design, and building
              products that make a difference.
            </p>
            <p>
              When I'm not coding, I'm exploring the intersection of technology
              and creativity through music, instrument building, and design.
            </p>
            <div class="mt-6">
              <h3
                class="mb-3 text-lg font-semibold text-stone-900 dark:text-stone-100"
              >
                Skills
              </h3>
              <div class="flex flex-wrap gap-2">
                {
                  [
                    "JavaScript ES2015",
                    "TypeScript",
                    "HTML",
                    "CSS",
                    "GraphQL",
                    "React",
                    "Next.js",
                    "Node.js",
                    "Tailwind",
                    "Git",
                  ].map((skill) => (
                    <span class="rounded-full bg-stone-200 px-3 py-1 text-sm font-medium text-stone-700 dark:bg-stone-800 dark:text-stone-300">
                      {skill}
                    </span>
                  ))
                }
              </div>
            </div>
          </div>
        </section>

        <!-- Experience Section -->
        <section id="experience" class="animate mb-24 scroll-mt-36">
          <h2
            class="mb-8 text-3xl font-bold text-stone-900 dark:text-stone-100"
          >
            Experience
          </h2>
          <div class="space-y-8">
            {
              experiences.map((exp) => (
                <a
                  href={exp.url}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="group relative block rounded-lg border border-stone-300/50 bg-stone-100/50 p-6 transition-all duration-300 hover:border-stone-400/50 hover:bg-stone-200/50 hover:shadow-lg dark:border-stone-700/50 dark:bg-stone-800/50 dark:hover:border-stone-600/50 dark:hover:bg-stone-700/50"
                >
                  <div class="absolute right-6 top-6 text-stone-400 transition-all duration-300 group-hover:-translate-y-1 group-hover:translate-x-1 group-hover:text-stone-900 dark:text-stone-600 dark:group-hover:text-stone-100">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <path d="M7 17L17 7" />
                      <path d="M7 7h10v10" />
                    </svg>
                  </div>
                  <div class="mb-2 flex flex-wrap items-baseline justify-between gap-2 pr-8">
                    <h3 class="text-xl font-bold text-stone-900 dark:text-stone-100">
                      {exp.title}
                    </h3>
                    <span class="font-mono text-sm text-stone-600 dark:text-stone-400">
                      {exp.period}
                    </span>
                  </div>
                  <p class="mb-3 text-base font-semibold text-stone-700 dark:text-stone-300">
                    {exp.company}
                  </p>
                  <p class="mb-4 text-base leading-relaxed text-stone-600 dark:text-stone-400">
                    {exp.description}
                  </p>
                  <div class="flex flex-wrap gap-2">
                    {exp.skills.map((skill) => (
                      <span class="rounded bg-stone-300/50 px-2 py-1 text-xs font-medium text-stone-700 dark:bg-stone-700/50 dark:text-stone-300">
                        {skill}
                      </span>
                    ))}
                  </div>
                </a>
              ))
            }
          </div>
        </section>

        <!-- Projects Section -->
        <section id="projects" class="animate mb-24 scroll-mt-36">
          <h2
            class="mb-8 text-3xl font-bold text-stone-900 dark:text-stone-100"
          >
            Software Projects
          </h2>
          <ul class="not-prose flex flex-col gap-4">
            {
              projects.map((project) => (
                <li>
                  <ArrowCard entry={project} />
                </li>
              ))
            }
          </ul>
        </section>

        <!-- Writing Section -->
        <section id="writing" class="animate mb-24 scroll-mt-36">
          <h2
            class="mb-8 text-3xl font-bold text-stone-900 dark:text-stone-100"
          >
            Software Writing
          </h2>
          <ul class="not-prose flex flex-col gap-4">
            {
              blog.map((post) => (
                <li>
                  <ArrowCard entry={post} />
                </li>
              ))
            }
          </ul>
        </section>
      </aside>
    </div>
  </Container>
</Layout>

<Pelican />

<style>
  html {
    scroll-behavior: smooth;
  }
</style>

<script is:inline>
  function initializePage() {
    // Scroll spy for navigation
    const sections = document.querySelectorAll("section[id]");
    const navLinks = document.querySelectorAll(".nav-link");

    function setActiveLink(activeId) {
      navLinks.forEach((link) => {
        const underline = link.querySelector(".nav-underline");
        if (link.getAttribute("data-nav-link") === activeId) {
          link.classList.add("text-stone-900", "dark:text-stone-100");
          link.classList.remove("text-stone-700", "dark:text-stone-300");
          if (underline) {
            underline.style.width = "100%";
          }
        } else {
          link.classList.remove("text-stone-900", "dark:text-stone-100");
          link.classList.add("text-stone-700", "dark:text-stone-300");
          if (underline) {
            underline.style.width = "0";
          }
        }
      });
    }

    // Intersection Observer for scroll spy
    const observerOptions = {
      root: null,
      rootMargin: "-144px 0px -50% 0px",
      threshold: 0.1,
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          setActiveLink(entry.target.id);
        }
      });
    }, observerOptions);

    sections.forEach((section) => {
      observer.observe(section);
    });

    // Set initial active state immediately
    if (sections.length > 0) {
      setActiveLink(sections[0].id);
    }

    // Add dynamic padding to sticky nav when scrolling
    const stickyNav = document.querySelector(".sticky.top-36");
    if (stickyNav) {
      stickyNav.style.transition =
        "padding-top 0.35s cubic-bezier(0.4,0,0.2,1)";
    }
    window.addEventListener("scroll", () => {
      if (stickyNav) {
        if (window.scrollY > 42) {
          stickyNav.style.paddingTop = "50px";
        } else {
          stickyNav.style.paddingTop = "0";
        }
      }
    });

    // Smooth scroll for nav links with proper offset
    navLinks.forEach((link) => {
      link.addEventListener("click", (e) => {
        e.preventDefault();
        const targetId = link.getAttribute("data-nav-link");
        const targetSection = document.getElementById(targetId);
        if (targetSection) {
          // Calculate position with offset for header (144px to match sticky top-36)
          const targetPosition = targetSection.offsetTop - 170;
          window.scrollTo({
            top: targetPosition,
            behavior: "smooth",
          });
        }
      });
    });
  }

  // Run on initial load
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initializePage);
  } else {
    initializePage();
  }
</script>
