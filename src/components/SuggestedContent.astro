---
import { type CollectionEntry } from "astro:content";
import ArrowCard from "@components/ArrowCard.astro";

type Props = {
  items: CollectionEntry<"blog">[] | CollectionEntry<"projects">[];
  currentSlug: string;
  type: "blog" | "projects";
  maxItems?: number;
};

const { items, currentSlug, type, maxItems = 4 } = Astro.props;

// Filter out current item and get random suggestions
const otherItems = items.filter(item => item.slug !== currentSlug);
const shuffled = otherItems.sort(() => 0.5 - Math.random());
const suggested = shuffled.slice(0, Math.min(maxItems, otherItems.length));

const title = type === "blog" ? "Related Blog Posts" : "Other Projects";
---

{suggested.length > 0 && (
  <div class="suggested-content">
    <h2 class="font-semibold text-black dark:text-white text-xl mb-4">
      {title}
    </h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      {suggested.map((item) => (
        <ArrowCard entry={item} />
      ))}
    </div>
  </div>
)}

<style>
  .suggested-content {
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  :global(.dark) .suggested-content {
    border-top-color: rgba(255, 255, 255, 0.1);
  }
</style>
